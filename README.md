инструмент для анализа и атаки на подписи ECDSA в транзакциях биткоина с целью восстановления приватного ключа. Он реализует методы, основанные на уязвимости в генерации nonce (случайного числа k) при подписании транзакций, используя алгоритмы, похожие на «half_parallel_attack».

Что делает код
Получает список транзакций для заданного биткоин-адреса через API mempool.space.

Загружает сырые данные транзакций с blockchain.info.

Парсит транзакции, извлекая подписи (r, s) и хеши сообщений (z).

Пытается восстановить приватный ключ, используя две подписи, которые используют одно и то же или близкое значение nonce k.

Проверяет найденный приватный ключ, сравнивая публичный ключ, полученный из него, с публичным ключом из транзакции.

Записывает результаты в файлы.

Основные функции
process_transactions(address, output_file): основной процесс, который запускает анализ для заданного адреса.

check_tx(address): получает список txid транзакций для адреса.

get_rawtx_from_blockchain(txid): получает сырой hex-транзакции по txid.

parseTx(txn): парсит сырую транзакцию, выделяя входы и подписи.

getSignableTxn(parsed): формирует хеши сообщений z для подписей.

recover_key_lsb(h, s, r) и recover_key_msb(h, s, r): пытаются восстановить приватный ключ, используя методы атаки на младшие и старшие биты nonce.

Верификация найденного приватного ключа с помощью библиотеки bitcoinlib и fastecdsa.

Как пользоваться
Установите необходимые библиотеки Python:

gmpy2

bitcoinlib

fastecdsa

requests (если понадобится)

Запустите скрипт из командной строки, передав биткоин-адрес для анализа и опционально имя файла для результатов:

bash
python rsz.py -a <биткоин-адрес> -o results.txt
Скрипт выведет прогресс и результаты в консоль, а также сохранит:

Все r, s, z значения в файл R_S_Z.txt.

Найденные приватные ключи и соответствующие публичные ключи и txid в указанный файл (по умолчанию results.txt).
